<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Show More Pagination</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description"
      content="How to create show more pagination">
  </head>
  <body>
    <h1>Show More Pagination</h1>

    This is an example to test a component which paginates with a 'Show More' button.
    We want to test it to make sure that the pagination works in connection with a screen reader.
    The idea is to focus the reader on the next new item when the "Show More" button is clicked.
    To do so, it is necessary to set the <code>tabindex</code> on the elements to make them focussable.

    <ul id="list">
      <li>Element 1</li>
      <li>Element 2</li>
      <li>Element 3</li>
      <li>Element 4</li>
    </ul>
    <button is="show-more-btn" data-list="#list">Show More</button>

    <script>
      if(this.customElements)
        try{customElements.define('built-in',document.createElement('p').constructor,{'extends':'p'})}
        catch(s){document.write('<script src="//unpkg.com/@ungap/custom-elements-builtin"><\x2fscript>')}
      else
        document.write('<script src="//unpkg.com/document-register-element"><\x2fscript>');
    </script>
    <script>
      function html2dom(html) {
        let tmp = document.createElement("html");
        tmp.innerHTML = html;

        let root = document.createDocumentFragment(); // allows for DOM queries
        [].slice.call(tmp.childNodes).forEach(node => {
          root.appendChild(node);
        });
        return root;
      }

      class ShowMorePagination extends HTMLButtonElement {
        connectedCallback() {
          this.counter = 5;
          this.addEventListener("click", ev => {
            ev.preventDefault();
            this.setAttribute("aria-pressed", "true");
            this.paginate();
          });
        }

        paginate () {

          var newUl = html2dom(`<ul>${this.dummyHtmlContent()}</ul>`);
          var lis = [].slice.call(newUl.querySelectorAll("li"));

          var firstLi = lis[0];
          var list = this.list
          lis.forEach(li => {
            list.appendChild(li);
          })
          firstLi.setAttribute("tabindex", "-1");

          firstLi.focus();

          this.setAttribute("aria-pressed", "false");
        }

        dummyHtmlContent () {
          return [0,1,2,3]
            .map(el => {
              var ctr = this.counter++
              return `<li>Element ${ctr}</li>`
            })
            .join("");
        }

        get list () {
          return document.querySelector(this.getAttribute("data-list"))
        }
      }
      customElements.define('show-more-btn', ShowMorePagination, { extends: 'button' })
    </script>
  </body>
</html>
